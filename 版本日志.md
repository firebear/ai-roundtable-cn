# 📋 AI圆桌中国版 - 版本日志

## 版本管理规则

每次开发新功能或修复bug时，版本号 **+0.0.1**，方便确认浏览器加载了最新版本。

---

## 版本历史

### v0.4.0 - 国产AI大扩充 🚀
**日期**: 2026-01-22 13:00
**状态**: 待测试

**重大更新**:
- ✅ 新增Kimi（月之暗面）完整支持
- ✅ 新增ChatGLM（智谱AI）完整支持
- ✅ 新增通义千问（阿里）完整支持
- ✅ 支持7个AI平台同时协作（3个国际 + 4个国产）

**新增文件**:
- `content/kimi.js` - Kimi平台适配脚本
- `content/chatglm.js` - ChatGLM平台适配脚本
- `content/qwen.js` - 通义千问平台适配脚本

**修改文件**:
- `manifest.json`: 版本0.4.0，添加3个新平台权限
- `sidepanel/panel.html`: 添加3个新平台UI（3处更新）
- `sidepanel/panel.js`: 添加3个新平台到AI类型列表
- `background.js`: 添加3个新平台URL模式

**支持平台列表**:
国际AI:
- Claude ✅
- ChatGPT ✅
- Gemini ✅

国产AI:
- DeepSeek ✅
- Kimi ✅
- ChatGLM ✅
- 通义千问 ✅

**测试建议**:
由于新增3个平台，建议逐个测试：
1. 先测试Kimi（最热门）
2. 再测试ChatGLM（有参考实现）
3. 最后测试通义千问

---

### v0.3.0 - 第一个稳定版本 🎉
**日期**: 2026-01-22 12:30
**状态**: 稳定版

**重大更新**:
- ✅ 完成DeepSeek平台集成
- ✅ 消息自动填入功能
- ✅ 响应自动捕获功能
- ✅ 手动点击发送模式（发送按钮高亮提示）
- ✅ 清理所有调试代码

**工作模式**:
1. 用户在侧边栏输入消息
2. 插件自动填入消息到DeepSeek输入框
3. **发送按钮高亮闪烁3秒**，提示用户手动点击
4. 插件自动捕获DeepSeek的响应
5. 响应自动同步到侧边栏，可参与讨论模式

**支持平台**:
- Claude ✅
- ChatGPT ✅
- Gemini ✅
- DeepSeek ✅（新增）

**注意事项**:
- DeepSeek需要手动点击发送按钮（由于技术限制）
- 其他平台支持完全自动化

---

### v0.2.6 - React事件访问版本
**日期**: 2026-01-22 12:10
**状态**: 测试失败

**修改内容**:
- ✅ 新增方法1：直接访问React内部props调用onClick
- ✅ 改进方法4：鼠标事件添加坐标信息（clientX、clientY）
- ✅ 改进方法5：改为直接点击SVG元素
- ✅ 优化方法顺序（React → 键盘 → 标准点击 → 鼠标事件 → SVG点击）

**技术改进**:
- 尝试访问React内部属性（`__react`、`__reactFiber`等）
- 鼠标事件添加完整的坐标和按钮状态
- 更精准的SVG元素定位

**测试结果**:
- ❌ React内部属性未找到（控制台无相关日志）
- ❌ 所有点击方法均无效
- ✅ 手动点击模式完全可行（消息自动填入，用户手动点击发送，响应自动捕获）

**结论**:
- DeepSeek的发送按钮可能有特殊的防护机制或使用特殊的事件处理方式
- 继续调试自动点击可能投入产出比较低
- **推荐采用手动点击模式**作为最终方案

---

### v0.2.5 - 多种点击方法测试版本
**日期**: 2026-01-22 12:01
**状态**: 测试失败（所有点击方法无效）

**修改内容**:
- ✅ 增强了发送按钮点击逻辑（5种点击方法）
- ✅ 添加了详细的点击过程日志
- ✅ 针对div按钮添加了mousedown/mouseup/click事件序列
- ✅ 尝试点击内部元素（SVG等）

**调试目的**:
- 修复发送按钮无法触发的问题
- 测试多种点击方法，找到能触发DeepSeek发送的方法

**测试方法**:
1. 重新加载扩展（版本号0.2.5）
2. 刷新DeepSeek页面
3. 发送测试消息
4. 查看控制台的点击方法日志

---

### v0.2.3 - 页面结构调试版本
**日期**: 2026-01-22 11:56
**状态**: 部分成功

**修改内容**:
- ✅ 增强了 `waitForStreamingComplete()` 函数的调试日志
- ✅ 添加了 `debugPageStructure()` 函数，输出页面DOM结构
- ✅ 在页面初始化时自动输出调试信息
- ✅ 添加了响应捕获计数的详细日志

**测试结果**:
- ✅ 发现了正确的消息选择器：`div[class*="markdown"]`
- ✅ 响应捕获成功！捕获到了126字符的回复
- ❌ 发送按钮点击失败（需要手动点击）
- ❌ 时间差问题：自动捕获在回复出现前就停止了

**重大发现**:
- ✅ **DeepSeek的回复使用 `div` 元素，class包含 "markdown"**
- ✅ 响应捕获功能完全正常！

---

### v0.2.2 - 响应捕获调试版本
**日期**: 2026-01-22 11:56
**状态**: 调试中

**修改内容**:
- ✅ 增强了 `waitForStreamingComplete()` 函数的调试日志
- ✅ 添加了 `debugPageStructure()` 函数，输出页面DOM结构
- ✅ 在页面初始化时自动输出调试信息
- ✅ 添加了响应捕获计数的详细日志

**调试目的**:
- 分析DeepSeek页面的实际DOM结构
- 找到消息容器的真实class名称
- 验证响应捕获函数是否被正确调用

**测试方法**:
1. 重新加载扩展（版本号0.2.3）
2. **刷新DeepSeek页面**（重要！会自动输出页面结构）
3. 查看控制台输出的"Page Structure Debug"信息
4. 发送测试消息，查看响应捕获过程

---

### v0.2.2 - 响应捕获调试版本
**日期**: 2026-01-22 11:53
**状态**: 测试失败

**修改内容**:
- ✅ 增强了 `checkForNewMessages()` 函数的调试日志
- ✅ 添加了更多消息选择器（markdown-prose、article、data-testid等）
- ✅ 增强了 `findChatContainer()` 的调试日志

**测试结果**:
- ✅ 消息成功发送
- ❌ 聊天容器日志未显示（可能页面加载时控制台未打开）
- ❌ 消息选择器全未匹配（0 chars）

**问题**:
- 需要查看DeepSeek页面的实际DOM结构

---

### v0.2.1 - 发送按钮调试版本
**日期**: 2026-01-22 11:50
**状态**: 部分成功

**修改内容**:
- ✅ 增强了 `findSendButton()` 函数的调试日志
- ✅ 添加了所有按钮元素的详细输出
- ✅ 扩展了按钮匹配规则（包含空文本、icon、button等关键词）

**测试结果**:
- ✅ 成功找到发送按钮：`_7d1f5e2 ds-icon-button ds-icon-button--l ds-icon-button--sizing-icon`
- ✅ 消息成功发送
- ❌ 响应捕获失败（0 chars）

**问题**:
- 响应捕获的选择器不匹配DeepSeek的DOM结构

---

### v0.2.0 - DeepSeek基础支持
**日期**: 2026-01-22 11:45
**状态**: 测试失败

**新增功能**:
- ✅ 创建 `content/deepseek.js` - DeepSeek平台适配脚本
- ✅ 修改 `manifest.json` - 添加DeepSeek权限
- ✅ 修改 `sidepanel/panel.html` - 添加DeepSeek UI元素
- ✅ 修改 `sidepanel/panel.js` - 添加DeepSeek到AI类型列表
- ✅ 修改 `background.js` - 添加DeepSeek URL模式和存储
- ✅ 修改产品名称为"AI圆桌 中国版"

**问题**:
- ❌ DeepSeek发送按钮无法找到
- ❌ 错误：`Could not find send button`

---

### v0.1.5 - 原始版本
**来源**: [axtonliu/ai-roundtable](https://github.com/axtonliu/ai-roundtable)

**支持平台**:
- Claude
- ChatGPT
- Gemini

---

## 下一步计划

### v0.4.0 - 添加更多国产AI模型
**计划**:
- [ ] Kimi（月之暗面）
- [ ] 通义千问（阿里）
- [ ] 文心一言（百度）
- [ ] ChatGLM（智谱AI）

### v0.5.0 - 功能优化
- [ ] 尝试解决DeepSeek自动点击问题
- [ ] 添加更多讨论模式选项
- [ ] 支持自定义AI配置

---

## 版本更新流程

1. **修改代码**
2. **更新版本号** (manifest.json中的version字段)
3. **在版本日志中记录改动**
4. **重新加载扩展**
5. **测试功能**
6. **记录测试结果**

---

## 开发者备注

- 每次修改后记得更新此文件
- 版本号规则：`主版本.次版本.补丁版本`
- 测试版本快速迭代：只增加补丁版本号（+0.0.1）
- 重大功能更新：增加次版本号（+0.1.0）
